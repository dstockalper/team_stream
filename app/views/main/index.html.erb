<nav class="navbar navbar-default navbar-fixed-top" role="navigation"> 
	<div class="container">
		<div class="navbar-header">
			<a href="#intro" class="navbar-brand">TeamStream</a>
		</div>
	
		<ul class="nav navbar-nav">
			<li><a href="#about">About</a></li>
			<li><a href="#stats">Stats</a></li>
			<li><a href="#tweets">Tweets</a></li>
			<li><a href="#contact">Contact</a></li>
		</ul>
	</div>
</nav>
<div class="intro-section" id="intro">
	<div class="container">
		<h2 class="sign">TeamStream</h2>
		<div class="hero">
			<div class="row">
				<div class="col-md-4"><h3 class="intro-header">Your Team</h3></div>
				<div class="col-md-8"><h3 class="intro-header">How they doing</h3></div>
			</div>
			<div class="row">
				<div class="col-md-4">
					<div class="main-team">
						<%= image_tag "49ers.gif", :class => "logo" %>
					</div>
				</div>
				<div class="col-md-8">
					<h2>The 49ers<br>
						<span data-typer-targets="suck,rule,are the worst team in the league,are going to win the SuperBowl">are awesome</span>.
					</h2>
				</div>
			</div>

			<div class="row charts">
				<div class="col-md-4 odd">
					<h3 class="intro-header">Sentiment</h3>
					<div id="chartdiv-gauge"></div>
				</div>
				<div class="col-md-4 even">
					<h3 class="intro-header">Overall</h3>
					<p class="chart-info">Positive</p>
				</div>
				<div class="col-md-4 odd">
					<h3 class="intro-header">Latest Tweet</h3>
					<p class="chart-info">49ers are my favorite</p>
				</div>
			</div>
			<div class="row">
				<h3 class="intro-header">History</h3>
				<div id="chartdiv-line"></div>
			</div>
			



		</div><!-- end of hero -->
	</div><!-- end of container -->
</div> <!-- end of intro-section -->

<section>
	<button id="proxy">Tweet Score with Proxy </button>
	<div id="ajax_div"></div>
</section>






<div id="about">
	<div class="container">
		
		<div class="row icons">
			<div class="col-md-4">
				<span class="glyphicon glyphicon-cloud center-block"><span>
			</div>
			<div class="col-md-4">
				<span class="glyphicon glyphicon-screenshot center-block"><span>
			</div>
			<div class="col-md-4">
				<span class="glyphicon glyphicon-signal center-block"><span>
			</div>
		</div>
		<div class="row about">
			<div class="col-md-4">
				<h3>Ruby on Rails</h3>
				<p>We are using Ruby on Rails to to create this fun little app to see how your team stands in the social world.</p>
			</div>

			<div class="col-md-4">
				<h3>Semantic Api</h3>
				<p>Using <a href="http://www.alchemyapi.com/">Alchemy API</a>, we determine the sentiment of tweets that mention your particular team. The API gives a score that determines if people are talking shit or supporting your team.</p>
			</div>
			<div class="col-md-4">
				<h3>Amchart</h3>
				<p>We use <a href="http://www.amcharts.com/">Amchart</a> to map out the incoming data to visualize the sentiment towards your lame ass team. </p>
			</div>
		</div><!-- end of row -->
		

	</div>
</div><!-- end of about -->

<div id="stats">
	<div class="container">
	<h2 class="section-titles">Stats</h2>
</div>
</div>

<div id="tweets">
	<div class="container">
		<h2 class="section-titles">Tweets</h2>
	</div>
</div>

<div id="contact">
	<div class="container">
		<h2 class="section-titles">Contact</h2>
	</div>
</div>

<script> 
	$(function() {
		$('[data-typer-targets]').typer();
	});
</script>



  <!-- AJAX call ================================================ -->

	<script type="text/javascript">

	$(document).ready(function(){
		
		var request = $.ajax({
		  url: "/get_data",
		 	dataType: "json"
		});

		request.done(function(data){
			console.log(data)
			$('#ajax_div').text(data[5].score)

			
			// CHART****************************************************
			var chartData = generatechartData();

			function generatechartData() {
			    var chartData = [];
			    var firstDate = new Date();
			    firstDate.setDate(firstDate.getDate() - 1);
			    console.log(firstDate);
			    for (var i = 0; i < data.length; i++) {
			        // we create date objects here. In your data, you can have date strings
			        // and then set format of your dates using chart.dataDateFormat property,
			        // however when possible, use date objects, as this will speed up chart rendering.
			        var newDate = new Date(firstDate);
			        newDate.setDate(newDate.getDate() + i);

			        var time_of_tweet = data[i].created_at;
			        var sentiment_score = data[i].score;
			        console.log("created at: " + time_of_tweet);
			        console.log("score: " + sentiment_score);


			        chartData.push({
			            date: time_of_tweet,
			            visits: sentiment_score
			        });
			    }
			    return chartData;
			}


			var chart_line = AmCharts.makeChart("chartdiv-line", {
			    "theme": "none",	
			    "type": "serial",
					"autoMargins": false,
					"marginLeft":8,
					"marginRight":8,
					"marginTop":10,
					"marginBottom":26,
			    "pathToImages": "http://www.amcharts.com/lib/3/images/",
			    "dataProvider": chartData,
			    "valueAxes": [{
			        "axisAlpha": 0,
			        "inside": true
			    }],
			    "graphs": [{
			        "balloonText": "[[category]]<br><b>value: [[value]]</b>",
			        "bullet": "round",
			        "bulletBorderAlpha": 1,
			        "bulletBorderColor": "#FFFFFF",
			        "hideBulletsCount": 50,
			        "lineThickness": 2,
			        "lineColor": "#fdd400",
			        "negativeLineColor": "#67b7dc",
			        "valueField": "visits"
			    }],
			    "chartScrollbar": {
			    },
			    "chartCursor": {
			    },
			    "categoryField": "date",
			    "categoryAxis": {
			    	"minPeriod": "mm",
			        "parseDates": true,
			        "axisAlpha": 0,
			        "minHorizontalGap":60
			    }
			});

			chart_line.addListener("dataUpdated", zoomChart);
			//zoomChart();

			function zoomChart(){
			  if(chart_line.zoomToIndexes){
			    chart_line.zoomToIndexes(130, chartData.length - 1);
			  }
			}

			// CHART****************************************************


			$('#ajax_div').text(data[59].score)


		});
	})

</script>
